{% extends 'admin_config/base.html' %}
{% load static %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1><i class="fas fa-file-code me-2"></i>Configuration Templates</h1>
            <div>
                <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addTemplateModal">
                    <i class="fas fa-plus me-1"></i>Create Template
                </button>
                <button class="btn btn-primary ms-2" onclick="importTemplate()">
                    <i class="fas fa-upload me-1"></i>Import Template
                </button>
            </div>
        </div>

        <!-- Template Categories -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <div class="btn-group" role="group" aria-label="Template categories">
                            <button type="button" class="btn btn-outline-primary active"
                                onclick="filterTemplates('all', this)">
                                All Templates
                            </button>
                            <button type="button" class="btn btn-outline-primary"
                                onclick="filterTemplates('crm', this)">
                                CRM Integrations
                            </button>
                            <button type="button" class="btn btn-outline-primary"
                                onclick="filterTemplates('meeting', this)">
                                Meeting Platforms
                            </button>
                            <button type="button" class="btn btn-outline-primary"
                                onclick="filterTemplates('workflow', this)">
                                Workflows
                            </button>
                            <button type="button" class="btn btn-outline-primary"
                                onclick="filterTemplates('custom', this)">
                                Custom Templates
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Templates Grid -->
        <div class="row" id="templatesGrid">
            <!-- CRM Templates -->
            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="crm">
                <div class="card h-100">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">
                            <i class="fab fa-salesforce me-2"></i>Salesforce Integration
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Complete Salesforce CRM integration with lead sync, opportunity management,
                            and automated workflows.</p>
                        <div class="mb-3">
                            <span class="badge bg-success">Popular</span>
                            <span class="badge bg-info">OAuth 2.0</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('salesforce')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('salesforce')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="crm">
                <div class="card h-100">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="card-title mb-0">
                            <i class="fab fa-hubspot me-2"></i>HubSpot Integration
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">HubSpot CRM integration with contact management, deal tracking, and
                            marketing automation.</p>
                        <div class="mb-3">
                            <span class="badge bg-success">Popular</span>
                            <span class="badge bg-info">API Key</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('hubspot')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('hubspot')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="crm">
                <div class="card h-100">
                    <div class="card-header bg-success text-white">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-funnel-dollar me-2"></i>Pipedrive Integration
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Pipedrive CRM integration with pipeline management, activity tracking, and
                            sales reporting.</p>
                        <div class="mb-3">
                            <span class="badge bg-info">API Key</span>
                            <span class="badge bg-secondary">REST API</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('pipedrive')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('pipedrive')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meeting Platform Templates -->
            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="meeting">
                <div class="card h-100">
                    <div class="card-header bg-info text-white">
                        <h5 class="card-title mb-0">
                            <i class="fab fa-google me-2"></i>Google Meet Integration
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Google Meet integration with calendar sync, meeting creation, and
                            transcript analysis.</p>
                        <div class="mb-3">
                            <span class="badge bg-success">Active</span>
                            <span class="badge bg-info">OAuth 2.0</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('google-meet')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('google-meet')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="meeting">
                <div class="card h-100">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title mb-0">
                            <i class="fab fa-microsoft me-2"></i>Microsoft Teams Integration
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Microsoft Teams integration with channel management, meeting scheduling,
                            and recording access.</p>
                        <div class="mb-3">
                            <span class="badge bg-success">Active</span>
                            <span class="badge bg-info">Azure AD</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('teams')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('teams')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workflow Templates -->
            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="workflow">
                <div class="card h-100">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-robot me-2"></i>Lead Nurturing Workflow
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Automated lead nurturing workflow with email sequences, follow-ups, and
                            conversion tracking.</p>
                        <div class="mb-3">
                            <span class="badge bg-warning">Automation</span>
                            <span class="badge bg-info">AI-Powered</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm" onclick="previewTemplate('lead-nurturing')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('lead-nurturing')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4 template-card" data-category="workflow">
                <div class="card h-100">
                    <div class="card-header bg-dark text-white">
                        <h5 class="card-title mb-0">
                            <i class="fas fa-calendar-check me-2"></i>Meeting Follow-up Workflow
                        </h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">Automated post-meeting workflow with summary generation, action items, and
                            follow-up scheduling.</p>
                        <div class="mb-3">
                            <span class="badge bg-warning">Automation</span>
                            <span class="badge bg-success">Meeting</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-outline-primary btn-sm"
                                onclick="previewTemplate('meeting-followup')">
                                <i class="fas fa-eye me-1"></i>Preview
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="useTemplate('meeting-followup')">
                                <i class="fas fa-download me-1"></i>Use Template
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="row" id="emptyState" style="display: none;">
            <div class="col-12 text-center py-5">
                <i class="fas fa-file-code fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No templates found</h4>
                <p class="text-muted">Try adjusting your filter or create a new template.</p>
            </div>
        </div>
    </div>
</div>

<!-- Add Template Modal -->
<div class="modal fade" id="addTemplateModal" tabindex="-1" aria-labelledby="addTemplateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addTemplateModalLabel">Create New Template</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addTemplateForm">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="templateName" class="form-label">Template Name</label>
                                <input type="text" class="form-control" id="templateName" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="templateCategory" class="form-label">Category</label>
                                <select class="form-select" id="templateCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="crm">CRM Integration</option>
                                    <option value="meeting">Meeting Platform</option>
                                    <option value="workflow">Workflow</option>
                                    <option value="custom">Custom</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="templateDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="templateDescription" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="templateConfig" class="form-label">Configuration JSON</label>
                        <textarea class="form-control" id="templateConfig" rows="10"
                            placeholder='{"api_endpoint": "", "auth_type": "", "fields": {}}'></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="templateTags" class="form-label">Tags (comma-separated)</label>
                        <input type="text" class="form-control" id="templateTags" placeholder="oauth, api, integration">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="saveTemplate()">Save Template</button>
            </div>
        </div>
    </div>
</div>

<!-- Template Preview Modal -->
<div class="modal fade" id="templatePreviewModal" tabindex="-1" aria-labelledby="templatePreviewModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="templatePreviewModalLabel">Template Preview</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="templatePreviewContent">
                    <!-- Preview content will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="useTemplateBtn">Use This Template</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'admin_config/js/templates.js' %}"></script>
{% endblock %}